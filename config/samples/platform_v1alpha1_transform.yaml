# Example Transform for a WebService platform
# Transform is a platform definition that generates a CRD for developers to use.
# Platform engineers create Transforms, which generate CRDs (e.g., WebService).
# Developers then create instances of those CRDs to deploy their applications.
apiVersion: platform.platform.example.com/v1alpha1
kind: Transform
metadata:
  name: webservice
  namespace: default
spec:
  # Reference to the CUE platform module
  # Currently only "embedded" type is fully supported
  cueRef:
    type: embedded
    ref: webservice

  # Optional: Override the API group for generated CRD
  # Defaults to "pequod.io"
  group: apps.example.com

  # Optional: Override the API version
  # Defaults to "v1alpha1"
  version: v1alpha1

  # Optional: Short names for the generated CRD
  shortNames:
    - ws

  # Optional: Categories for the generated CRD
  categories:
    - pequod
    - platform

  # Optional: Declare managed resources for dynamic RBAC generation
  # The operator will create ClusterRoles/Roles with these permissions
  managedResources:
    - apiGroup: apps
      resources:
        - deployments
    - apiGroup: ""
      resources:
        - services
        - configmaps

  # Optional: RBAC scope determines where RBAC resources are created
  # Cluster: Creates a ClusterRole aggregated into the manager's permissions
  # Namespace: Creates a Role and RoleBinding in the Transform's namespace
  # Defaults to "Cluster"
  rbacScope: Cluster
